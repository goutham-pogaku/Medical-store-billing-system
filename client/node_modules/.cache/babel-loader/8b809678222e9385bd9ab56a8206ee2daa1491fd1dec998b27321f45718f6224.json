{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import config from'../config';import Navbar from'./Navbar';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BillHistory=()=>{const[bills,setBills]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{fetchBills();},[]);const fetchBills=async()=>{try{const response=await axios.get(\"\".concat(config.API_BASE_URL,\"/bills\"));setBills(response.data);}catch(error){console.error('Error fetching bills:',error);}finally{setLoading(false);}};const reprintBill=async billId=>{try{const response=await axios.get(\"\".concat(config.API_BASE_URL,\"/bills/\").concat(billId));printBill(response.data);}catch(error){alert('Error fetching bill details');}};const printBill=billData=>{const printWindow=window.open('','_blank');const billHtml=\"\\n      <html>\\n        <head>\\n          <title>Bill - \".concat(billData.bill_number,\"</title>\\n          <style>\\n            body { font-family: Arial, sans-serif; margin: 20px; }\\n            .header { text-align: center; margin-bottom: 20px; }\\n            .bill-details { margin-bottom: 20px; }\\n            table { width: 100%; border-collapse: collapse; }\\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\\n            th { background-color: #f2f2f2; }\\n            .totals { margin-top: 20px; text-align: right; }\\n            .total-row { font-weight: bold; }\\n          </style>\\n        </head>\\n        <body>\\n          <div class=\\\"header\\\">\\n            <h2>Medical Store Bill</h2>\\n            <p>Bill No: \").concat(billData.bill_number,\"</p>\\n            <p>Date: \").concat(new Date(billData.created_at).toLocaleDateString(),\"</p>\\n          </div>\\n          \\n          <div class=\\\"bill-details\\\">\\n            <p><strong>Customer:</strong> \").concat(billData.customer_name,\"</p>\\n            \").concat(billData.customer_phone?\"<p><strong>Phone:</strong> \".concat(billData.customer_phone,\"</p>\"):'',\"\\n          </div>\\n          \\n          <table>\\n            <thead>\\n              <tr>\\n                <th>Item</th>\\n                <th>Qty</th>\\n                <th>Rate</th>\\n                <th>GST%</th>\\n                <th>Amount</th>\\n                <th>GST Amt</th>\\n                <th>Total</th>\\n              </tr>\\n            </thead>\\n            <tbody>\\n              \").concat(billData.items.map(item=>\"\\n                <tr>\\n                  <td>\".concat(item.item_name,\"</td>\\n                  <td>\").concat(item.quantity,\"</td>\\n                  <td>\\u20B9\").concat(parseFloat(item.unit_price).toFixed(2),\"</td>\\n                  <td>\").concat(item.gst_rate,\"%</td>\\n                  <td>\\u20B9\").concat(parseFloat(item.item_total).toFixed(2),\"</td>\\n                  <td>\\u20B9\").concat(parseFloat(item.gst_amount).toFixed(2),\"</td>\\n                  <td>\\u20B9\").concat((parseFloat(item.item_total)+parseFloat(item.gst_amount)).toFixed(2),\"</td>\\n                </tr>\\n              \")).join(''),\"\\n            </tbody>\\n          </table>\\n          \\n          <div class=\\\"totals\\\">\\n            <p>Subtotal: \\u20B9\").concat(parseFloat(billData.subtotal).toFixed(2),\"</p>\\n            <p>Total GST: \\u20B9\").concat(parseFloat(billData.total_gst).toFixed(2),\"</p>\\n            \").concat(parseFloat(billData.discount_percent)>0?\"<p>Discount (\".concat(billData.discount_percent,\"%): -\\u20B9\").concat(parseFloat(billData.discount_amount).toFixed(2),\"</p>\"):'',\"\\n            <p class=\\\"total-row\\\">Final Amount: \\u20B9\").concat(parseFloat(billData.final_amount).toFixed(2),\"</p>\\n          </div>\\n          \\n          <script>\\n            window.onload = function() {\\n              window.print();\\n              window.onafterprint = function() {\\n                window.close();\\n              }\\n            }\\n          </script>\\n        </body>\\n      </html>\\n    \");printWindow.document.write(billHtml);printWindow.document.close();};if(loading){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading bills...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"bill-history-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bill-history-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Bill History\"})}),bills.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-bills\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No bills found\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"bills-table\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Bill Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bills.map(bill=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:bill.bill_number}),/*#__PURE__*/_jsx(\"td\",{children:new Date(bill.created_at).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:bill.customer_name}),/*#__PURE__*/_jsx(\"td\",{children:bill.items_summary}),/*#__PURE__*/_jsxs(\"td\",{children:[\"\\u20B9\",parseFloat(bill.final_amount).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>reprintBill(bill.id),className:\"reprint-btn\",children:\"Reprint\"})})]},bill.id))})]})})]})]});};export default BillHistory;","map":{"version":3,"names":["React","useState","useEffect","axios","config","Navbar","jsx","_jsx","jsxs","_jsxs","BillHistory","bills","setBills","loading","setLoading","fetchBills","response","get","concat","API_BASE_URL","data","error","console","reprintBill","billId","printBill","alert","billData","printWindow","window","open","billHtml","bill_number","Date","created_at","toLocaleDateString","customer_name","customer_phone","items","map","item","item_name","quantity","parseFloat","unit_price","toFixed","gst_rate","item_total","gst_amount","join","subtotal","total_gst","discount_percent","discount_amount","final_amount","document","write","close","children","className","length","bill","items_summary","onClick","id"],"sources":["/Users/pogakugouthamgoud/Desktop/Clickpay/med/medical-billing/client/src/components/BillHistory.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport config from '../config';\r\nimport Navbar from './Navbar';\r\n\r\nconst BillHistory = () => {\r\n  const [bills, setBills] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchBills();\r\n  }, []);\r\n\r\n  const fetchBills = async () => {\r\n    try {\r\n      const response = await axios.get(`${config.API_BASE_URL}/bills`);\r\n      setBills(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching bills:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const reprintBill = async (billId) => {\r\n    try {\r\n      const response = await axios.get(`${config.API_BASE_URL}/bills/${billId}`);\r\n      printBill(response.data);\r\n    } catch (error) {\r\n      alert('Error fetching bill details');\r\n    }\r\n  };\r\n\r\n  const printBill = (billData) => {\r\n    const printWindow = window.open('', '_blank');\r\n    const billHtml = `\r\n      <html>\r\n        <head>\r\n          <title>Bill - ${billData.bill_number}</title>\r\n          <style>\r\n            body { font-family: Arial, sans-serif; margin: 20px; }\r\n            .header { text-align: center; margin-bottom: 20px; }\r\n            .bill-details { margin-bottom: 20px; }\r\n            table { width: 100%; border-collapse: collapse; }\r\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\r\n            th { background-color: #f2f2f2; }\r\n            .totals { margin-top: 20px; text-align: right; }\r\n            .total-row { font-weight: bold; }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <div class=\"header\">\r\n            <h2>Medical Store Bill</h2>\r\n            <p>Bill No: ${billData.bill_number}</p>\r\n            <p>Date: ${new Date(billData.created_at).toLocaleDateString()}</p>\r\n          </div>\r\n          \r\n          <div class=\"bill-details\">\r\n            <p><strong>Customer:</strong> ${billData.customer_name}</p>\r\n            ${billData.customer_phone ? `<p><strong>Phone:</strong> ${billData.customer_phone}</p>` : ''}\r\n          </div>\r\n          \r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th>Item</th>\r\n                <th>Qty</th>\r\n                <th>Rate</th>\r\n                <th>GST%</th>\r\n                <th>Amount</th>\r\n                <th>GST Amt</th>\r\n                <th>Total</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              ${billData.items.map(item => `\r\n                <tr>\r\n                  <td>${item.item_name}</td>\r\n                  <td>${item.quantity}</td>\r\n                  <td>₹${parseFloat(item.unit_price).toFixed(2)}</td>\r\n                  <td>${item.gst_rate}%</td>\r\n                  <td>₹${parseFloat(item.item_total).toFixed(2)}</td>\r\n                  <td>₹${parseFloat(item.gst_amount).toFixed(2)}</td>\r\n                  <td>₹${(parseFloat(item.item_total) + parseFloat(item.gst_amount)).toFixed(2)}</td>\r\n                </tr>\r\n              `).join('')}\r\n            </tbody>\r\n          </table>\r\n          \r\n          <div class=\"totals\">\r\n            <p>Subtotal: ₹${parseFloat(billData.subtotal).toFixed(2)}</p>\r\n            <p>Total GST: ₹${parseFloat(billData.total_gst).toFixed(2)}</p>\r\n            ${parseFloat(billData.discount_percent) > 0 ? `<p>Discount (${billData.discount_percent}%): -₹${parseFloat(billData.discount_amount).toFixed(2)}</p>` : ''}\r\n            <p class=\"total-row\">Final Amount: ₹${parseFloat(billData.final_amount).toFixed(2)}</p>\r\n          </div>\r\n          \r\n          <script>\r\n            window.onload = function() {\r\n              window.print();\r\n              window.onafterprint = function() {\r\n                window.close();\r\n              }\r\n            }\r\n          </script>\r\n        </body>\r\n      </html>\r\n    `;\r\n    \r\n    printWindow.document.write(billHtml);\r\n    printWindow.document.close();\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div>\r\n        <Navbar />\r\n        <div className=\"loading\">Loading bills...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Navbar />\r\n      <div className=\"bill-history-container\">\r\n        <div className=\"bill-history-header\">\r\n          <h2>Bill History</h2>\r\n        </div>\r\n\r\n        {bills.length === 0 ? (\r\n          <div className=\"no-bills\">\r\n            <p>No bills found</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"bills-table\">\r\n            <table>\r\n              <thead>\r\n                <tr>\r\n                  <th>Bill Number</th>\r\n                  <th>Date</th>\r\n                  <th>Customer</th>\r\n                  <th>Items</th>\r\n                  <th>Amount</th>\r\n                  <th>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {bills.map(bill => (\r\n                  <tr key={bill.id}>\r\n                    <td>{bill.bill_number}</td>\r\n                    <td>{new Date(bill.created_at).toLocaleDateString()}</td>\r\n                    <td>{bill.customer_name}</td>\r\n                    <td>{bill.items_summary}</td>\r\n                    <td>₹{parseFloat(bill.final_amount).toFixed(2)}</td>\r\n                    <td>\r\n                      <button \r\n                        onClick={() => reprintBill(bill.id)}\r\n                        className=\"reprint-btn\"\r\n                      >\r\n                        Reprint\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BillHistory;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}